@model ViewModels.BaseBriefVM

@{
    var isDependent = ViewData["Dependent"] != null && !string.IsNullOrEmpty(ViewData["Dependent"].ToString()) ? bool.Parse(ViewData["Dependent"].ToString()) : false;
    var elementId = ViewData["Id"] != null && !string.IsNullOrEmpty(ViewData["Id"].ToString()) ? ViewData["Id"].ToString() : "craft-id";
}

<div class="form-group">
    <label class="form-label fw-600">Craft</label>
    @Html.DropDownListFor(model => model.Id, new List<SelectListItem>() {
    new SelectListItem()
    {
    Value = (Model!=null&&Model.Id > 0)?Model.Id.ToString():"",
    Text = (Model!=null&&Model.Id > 0)?Model.Name:"",
    Selected = (Model!=null&&Model.Id > 0)?true:false,
    }},
    new
    {
    @id = elementId,
    @class = "form-control disable-field",
    data_val_required = Model.ErrorMessage,
    data_val = Model.IsValidationEnabled.ToString().ToLower()
    })
    <input type="hidden" name="Craft.Name" value="@Model.Name" />
    <span asp-validation-for="Id" class="validation-invalid-label craft-error-span"></span>
</div>

<script src="~/js/custom-scripts/Select2Methods.js"></script>
<script src="~/js/custom-scripts/administrative-division-select2.js"></script>
<script>
    $(function() {
        var isDependent = "@isDependent";
        var id = "#" + "@elementId";
        var pageSize = 10;
        var url = '/Craft/Select2';
        if (isDependent != "False") { 
            url = 'Craft/CustomSelect2'
        }
        var dataArray = function(params) {
            params.page = params.page || 1;
            var customParams = JSON.stringify({});
            if  (isDependent != "False")  {
                customParams = JSON.stringify({ EmployeeId: $("#employee-id").val(), ContractId: contractId });
            }
            return {
                prefix: params.term,
                pageSize: pageSize,
                pageNumber: params.page,
                customParams: customParams
            };
        };
        Select2AutoCompleteAjax(id, url, dataArray, pageSize, "Select Craft");
        onAdministrativeDivisionTypeChange(id,  "employee");
    });
</script>
